import{g as Js,a as Qs,r as x,u as et,j as e,s as st,c as tt,b as rt,m as it,d as bs,k as js,e as ce,f as C,h as ys,i as _s,P as Te,B as t,I as nt,T as o,l as F,X as vs,C as ws,n as ks,o as at,A as Q,D as ot,p as lt,q as ct,t as Ss,v as dt,w as j,x as Cs,U as ht,y as xt,z as pt,E as gt,F as ut,G as ft,H as ls,J as mt,K,M as bt,L as Y,N as Z,O as J,Q as re,R as cs,S as ke,V as jt,W as ds,Y as Se,Z as hs,_ as Ce,$ as yt,a0 as _t,a1 as vt,a2 as wt,a3 as ze,a4 as xs,a5 as ps,a6 as Ie,a7 as kt,a8 as ye}from"./index-bVy2mGaR.js";import{u as gs}from"./index-Xc4W-zy4.js";import{I as us,a as A,b as Fe,R as St,W as Ct,B as zt,P as It,c as _e,H as Ft}from"./InlineImageGallery-BQdTARFZ.js";import{S as We}from"./save-DRhRR__T.js";import{A as Wt,C as q,a as V,M as fs}from"./Modal-u7nC6TKC.js";import{S as Rt}from"./Snackbar-cpEFp3If.js";import{S as Ae}from"./sparkles-B9NV5IIn.js";import{M as At}from"./mail-Cq710S5B.js";import{C as Et}from"./calendar-Ck-CgaBx.js";import{P as Nt}from"./phone-CY7kMJRC.js";import{S as Tt}from"./send-86ChWBJy.js";import"./star-BAYNdmY-.js";import"./plus-DKxi3Bgd.js";function Mt(c){return String(c).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Dt(c){return parseFloat(c)}function Bt(c){return Js("MuiSkeleton",c)}Qs("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Lt=c=>{const{classes:d,variant:p,animation:l,hasChildren:g,width:m,height:b}=c;return rt({root:["root",p,l,g&&"withChildren",g&&!m&&"fitContent",g&&!b&&"heightAuto"]},Bt,d)},Ee=js`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,Ne=js`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Vt=typeof Ee!="string"?bs`
        animation: ${Ee} 2s ease-in-out 0.5s infinite;
      `:null,qt=typeof Ne!="string"?bs`
        &::after {
          animation: ${Ne} 2s linear 0.5s infinite;
        }
      `:null,Pt=st("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(c,d)=>{const{ownerState:p}=c;return[d.root,d[p.variant],p.animation!==!1&&d[p.animation],p.hasChildren&&d.withChildren,p.hasChildren&&!p.width&&d.fitContent,p.hasChildren&&!p.height&&d.heightAuto]}})(it(({theme:c})=>{const d=Mt(c.shape.borderRadius)||"px",p=Dt(c.shape.borderRadius);return{display:"block",backgroundColor:c.vars?c.vars.palette.Skeleton.bg:c.alpha(c.palette.text.primary,c.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${p}${d}/${Math.round(p/.6*10)/10}${d}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(c.vars||c).shape.borderRadius}},{props:({ownerState:l})=>l.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:l})=>l.hasChildren&&!l.width,style:{maxWidth:"fit-content"}},{props:({ownerState:l})=>l.hasChildren&&!l.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Vt||{animation:`${Ee} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(c.vars||c).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:qt||{"&::after":{animation:`${Ne} 2s linear 0.5s infinite`}}}]}})),Re=x.forwardRef(function(d,p){const l=et({props:d,name:"MuiSkeleton"}),{animation:g="pulse",className:m,component:b="span",height:z,style:y,variant:n="text",width:s,...v}=l,W={...l,animation:g,component:b,variant:n,hasChildren:!!v.children},T=Lt(W);return e.jsx(Pt,{as:b,ref:p,className:tt(T.root,m),ownerState:W,...v,style:{width:s,height:z,...y}})});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=ce("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=ce("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ce("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Gt=()=>{const c=document.createElement("canvas"),d=c.getContext("2d");d&&(d.textBaseline="top",d.font="14px Arial",d.fillText("fingerprint",2,2));const p=[navigator.userAgent,navigator.language,screen.colorDepth,screen.width,screen.height,new Date().getTimezoneOffset(),c.toDataURL()].join("|");let l=0;for(let g=0;g<p.length;g++){const m=p.charCodeAt(g);l=(l<<5)-l+m,l=l&l}return Math.abs(l).toString(36)},Ot=c=>{try{return JSON.parse(sessionStorage.getItem("viewedItems")||"[]").includes(c)}catch{return!1}},Xt=c=>{try{const d=JSON.parse(sessionStorage.getItem("viewedItems")||"[]");d.includes(c)||(d.push(c),sessionStorage.setItem("viewedItems",JSON.stringify(d)))}catch(d){console.error("Failed to mark item as viewed:",d)}},Yt=(c,d=!1)=>{x.useEffect(()=>{if(!c||!d||Ot(c))return;const l=setTimeout(async()=>{try{const{data:{user:g}}=await C.auth.getUser(),{error:m}=await C.from("item_views").insert({item_id:c,viewer_id:(g==null?void 0:g.id)||null,session_fingerprint:g?null:Gt()});m&&!m.message.includes("unique")?console.error("Failed to track view:",m):Xt(c)}catch(g){console.error("Failed to track view:",g)}},2e3);return()=>clearTimeout(l)},[c,d])},Zt=({itemId:c,draftData:d,enabled:p,debounceMs:l=1e3})=>{const[g,m]=x.useState("idle"),b=x.useRef(null),z=x.useRef("");return x.useEffect(()=>{if(!p)return;const y=JSON.stringify(d);if(y!==z.current)return z.current=y,b.current&&clearTimeout(b.current),m("saving"),b.current=setTimeout(async()=>{try{const{error:n}=await C.from("items").update({draft_data:d,has_draft:!0,draft_updated_at:new Date().toISOString()}).eq("id",c);if(n)throw n;m("saved"),setTimeout(()=>{m("idle")},2e3)}catch(n){console.error("Auto-save error:",n),m("error")}},l),()=>{b.current&&clearTimeout(b.current)}},[c,d,p,l]),{status:g}},Jt=({onPublish:c,onCancel:d,isPublishing:p,autoSaveStatus:l,hasChanges:g,isDraft:m,itemStatus:b})=>{const z=ys(),y=_s(z.breakpoints.down("md")),[n,s]=x.useState(!1);x.useEffect(()=>{if(l==="saving")s(!0);else if(l==="saved"){const T=setTimeout(()=>{s(!1)},1500);return()=>clearTimeout(T)}else(l==="idle"||l==="error")&&s(!1)},[l]);const v=()=>p||!n?null:l==="saving"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"primary.main",animation:"pulse 1.5s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.6},"50%":{opacity:1}}},children:e.jsx(We,{size:16})}):l==="saved"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"success.main",animation:"fadeIn 0.3s ease-in","@keyframes fadeIn":{"0%":{opacity:0,transform:"scale(0.8)"},"100%":{opacity:1,transform:"scale(1)"}}},children:e.jsx(We,{size:16})}):l==="error"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"error.main"},children:e.jsx(We,{size:16})}):null,W=()=>p?m?"Wird veröffentlicht...":"Wird gespeichert...":b==="draft"?"Veröffentlichen":b==="published"?"Änderungen speichern":b==="paused"?"Speichern":"Änderungen übernehmen";return e.jsx(e.Fragment,{children:e.jsxs(Te,{elevation:8,sx:{position:"fixed",bottom:y?16:32,left:"50%",transform:"translateX(-50%)",zIndex:1300,bgcolor:"background.paper",borderRadius:4,border:m?"2px solid":"1px solid",borderColor:m?"warning.main":"divider",boxShadow:m?"0 12px 48px rgba(237, 108, 2, 0.15)":"0 8px 32px rgba(0,0,0,0.08)",minWidth:y?"calc(100% - 32px)":"auto",maxWidth:y?"calc(100% - 32px)":600,overflow:"hidden"},children:[m&&e.jsxs(t,{sx:{bgcolor:"rgba(237, 108, 2, 0.04)",px:2.5,py:.75,borderBottom:"1px solid rgba(237, 108, 2, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:1.5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(nt,{size:14,color:"#ed6c02",style:{flexShrink:0}}),e.jsx(o,{variant:"body2",sx:{color:"#e65100",fontSize:"0.8125rem",fontWeight:500},children:"Änderungen werden automatisch gespeichert"})]}),e.jsx(t,{sx:{display:"flex",alignItems:"center",minWidth:20},children:v()})]}),e.jsxs(t,{sx:{p:1.5,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1.5,flexDirection:"row",position:"relative"},children:[e.jsx(F,{variant:"outlined",onClick:d,disabled:p,startIcon:e.jsx(vs,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:2.5,fontWeight:500},children:"Abbrechen"}),e.jsx(F,{variant:"contained",onClick:c,disabled:p||!g,startIcon:e.jsx(ws,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:3,fontWeight:600,bgcolor:m?"warning.main":"primary.main","&:hover":{bgcolor:m?"warning.dark":"primary.dark"}},children:W()})]})]})})},Qt=()=>{const{user:c}=ks(),[d,p]=x.useState([]),[l,g]=x.useState(!0);return x.useEffect(()=>{(async()=>{if(!c){p([]),g(!1);return}try{const{data:n,error:s}=await C.rpc("get_user_permissions",{check_user_id:c.id});if(s)throw s;const v=(n==null?void 0:n.map(W=>W.permission_name))||[];p(v)}catch(n){console.error("Error loading permissions:",n),p([])}finally{g(!1)}})()},[c]),{permissions:d,loading:l,hasPermission:y=>d.includes(y),hasAnyPermission:y=>y.some(n=>d.includes(n)),hasAllPermissions:y=>y.every(n=>d.includes(n))}},er=({itemId:c,itemStatus:d,onStatusChange:p})=>{const{hasPermission:l}=Qt(),[g,m]=x.useState(!1),[b,z]=x.useState(""),[y,n]=x.useState(!1),[s,v]=x.useState({open:!1,message:"",severity:"success"}),W=l("items.approve"),T=l("items.reject");if(!W&&!T)return null;const P=async()=>{n(!0);try{const{error:u}=await C.rpc("approve_item",{item_id:c});if(u)throw u;v({open:!0,message:"Inserat erfolgreich freigegeben",severity:"success"}),p==null||p()}catch(u){v({open:!0,message:`Fehler: ${u.message}`,severity:"error"})}finally{n(!1)}},ee=async()=>{if(!b.trim()){v({open:!0,message:"Bitte gib einen Grund für die Ablehnung an",severity:"error"});return}n(!0);try{const{error:u}=await C.rpc("reject_item",{item_id:c,reason:b});if(u)throw u;v({open:!0,message:"Inserat wurde abgelehnt",severity:"success"}),m(!1),z(""),p==null||p()}catch(u){v({open:!0,message:`Fehler: ${u.message}`,severity:"error"})}finally{n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(Te,{sx:{p:2,mb:3,bgcolor:"rgba(255, 152, 0, 0.08)",border:"2px solid",borderColor:"warning.main"},children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Wt,{size:20,style:{color:"#ed6c02"}}),e.jsx(o,{variant:"subtitle1",fontWeight:600,children:"Moderations-Aktionen"})]}),e.jsx(t,{display:"flex",alignItems:"center",gap:1,mb:2,children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Status: ",e.jsx("strong",{children:d==="published"?"Veröffentlicht":d==="archived"?"Archiviert":d==="draft"?"Entwurf":d})]})}),e.jsxs(t,{display:"flex",gap:2,children:[W&&d!=="published"&&e.jsx(F,{variant:"contained",color:"success",startIcon:e.jsx(at,{size:18}),onClick:P,disabled:y,sx:{textTransform:"none"},children:"Freigeben"}),T&&d==="published"&&e.jsx(F,{variant:"contained",color:"error",startIcon:e.jsx(Kt,{size:18}),onClick:()=>m(!0),disabled:y,sx:{textTransform:"none"},children:"Ablehnen / Sperren"}),d==="archived"&&e.jsx(Q,{severity:"warning",sx:{flex:1},children:"Dieses Inserat wurde archiviert"}),d==="published"&&e.jsx(Q,{severity:"success",sx:{flex:1},children:"Dieses Inserat ist veröffentlicht und öffentlich sichtbar"})]})]}),e.jsxs(ot,{open:g,onClose:()=>m(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(lt,{children:"Inserat ablehnen"}),e.jsxs(ct,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Bitte gib einen Grund für die Ablehnung an. Der Verkäufer wird benachrichtigt."}),e.jsx(Ss,{label:"Ablehnungsgrund",multiline:!0,rows:4,fullWidth:!0,value:b,onChange:u=>z(u.target.value),placeholder:"z.B. Verstößt gegen Nutzungsbedingungen, Unerlaubter Inhalt, Falsche Kategorie..."})]}),e.jsxs(dt,{children:[e.jsx(F,{onClick:()=>m(!1),children:"Abbrechen"}),e.jsx(F,{variant:"contained",color:"error",onClick:ee,disabled:y||!b.trim(),children:"Ablehnen"})]})]}),e.jsx(Rt,{open:s.open,autoHideDuration:6e3,onClose:()=>v({...s,open:!1}),children:e.jsx(Q,{severity:s.severity,onClose:()=>v({...s,open:!1}),children:s.message})})]})},sr=({show:c,targetElement:d,onClose:p,title:l,description:g,step:m=1,totalSteps:b=1})=>{const[z,y]=x.useState({top:0,left:0});return x.useEffect(()=>{if(!c||!d)return;const n=()=>{const s=d.getBoundingClientRect(),v=window.scrollY,W=window.scrollX;y({top:s.top+v-180,left:s.left+W+s.width/2})};return n(),window.addEventListener("resize",n),window.addEventListener("scroll",n),()=>{window.removeEventListener("resize",n),window.removeEventListener("scroll",n)}},[c,d]),!c||!d?null:e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0, 0, 0, 0.4)",zIndex:1400,animation:"fadeIn 0.3s ease-in-out","@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}}},onClick:p}),e.jsxs(t,{sx:{position:"absolute",top:z.top,left:z.left,transform:"translateX(-50%)",zIndex:1401,animation:"slideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)","@keyframes slideDown":{from:{opacity:0,transform:"translateX(-50%) translateY(-20px)"},to:{opacity:1,transform:"translateX(-50%) translateY(0)"}}},children:[e.jsxs(Te,{elevation:24,sx:{position:"relative",bgcolor:"white",borderRadius:3,p:3,maxWidth:360,boxShadow:"0 24px 64px rgba(0, 0, 0, 0.24)",border:"1px solid rgba(0, 0, 0, 0.06)","&::after":{content:'""',position:"absolute",bottom:-12,left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"12px solid transparent",borderRight:"12px solid transparent",borderTop:"12px solid white",filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1))"}},children:[e.jsx(j,{onClick:p,sx:{position:"absolute",top:8,right:8,width:32,height:32,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(vs,{size:18})}),e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[e.jsx(t,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 12px rgba(25, 118, 210, 0.3)"},children:e.jsx(Ae,{size:20,color:"white"})}),e.jsxs(t,{sx:{flex:1,pt:.5},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,mb:.5,color:"text.primary"},children:l}),b>1&&e.jsxs(o,{variant:"caption",sx:{color:"text.secondary",fontWeight:500},children:["Schritt ",m," von ",b]})]})]}),e.jsx(o,{variant:"body2",sx:{color:"text.secondary",lineHeight:1.6,mb:3},children:g}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:e.jsx(F,{onClick:p,variant:"contained",sx:{borderRadius:2,textTransform:"none",fontWeight:600,px:3,boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(25, 118, 210, 0.24)"}},children:"Verstanden"})})]}),e.jsx(t,{sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",mt:2,width:2,height:40,bgcolor:"primary.main",borderRadius:1,opacity:.4,animation:"pulse 2s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.4},"50%":{opacity:.8}}}})]})]})},tr=({userId:c,currentItemId:d})=>{const[p,l]=x.useState(null),[g,m]=x.useState([]),[b,z]=x.useState(0),[y,n]=x.useState(!0),s=Cs();x.useEffect(()=>{v()},[c]);const v=async()=>{try{const{data:u,error:B}=await C.from("profiles").select("id, full_name, avatar_url, created_at, show_seller_profile").eq("id",c).single();if(B)throw B;if(l(u),!u.show_seller_profile){n(!1);return}let G=C.from("items").select("id, title, price, images, status",{count:"exact"}).eq("user_id",c).eq("status","active");d&&(G=G.neq("id",d));const{data:se,error:ie,count:$}=await G.order("created_at",{ascending:!1}).limit(4);if(ie)throw ie;m(se||[]),z($||0)}catch(u){console.error("Error fetching seller data:",u)}finally{n(!1)}},W=u=>{const B=new Date(u),G=B.toLocaleDateString("de-DE",{month:"long"}),se=B.getFullYear();return`${G} ${se}`},T=u=>u?u.split(" ").map(B=>B[0]).join("").toUpperCase().slice(0,2):"U",P=()=>{s(`/?seller=${c}`)},ee=u=>{s(`/item/${u}`)};return y?e.jsx(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Re,{variant:"circular",width:60,height:60}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(Re,{variant:"text",width:"60%",height:24}),e.jsx(Re,{variant:"text",width:"40%",height:20})]})]})}):!p||!p.show_seller_profile?e.jsx(t,{sx:{p:2,bgcolor:"#f5f5f5",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ht,{size:16,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",fontWeight:500,children:"Privater Verkäufer"})]})}):e.jsxs(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:2,mb:3},children:[e.jsx(xt,{src:p.avatar_url||void 0,sx:{width:60,height:60,bgcolor:"#1976d2",fontSize:"1.25rem",fontWeight:600},children:T(p.full_name)}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"h6",fontWeight:600,sx:{mb:.5},children:p.full_name||"Benutzer"}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Mitglied seit ",W(p.created_at)]}),b>0&&e.jsxs(o,{variant:"body2",color:"primary",fontWeight:500,sx:{mt:.5},children:[b," ",b===1?"aktives Inserat":"aktive Inserate"]})]})]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"subtitle2",fontWeight:600,sx:{mb:1.5},children:"Weitere Inserate"}),e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,mb:2,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3}},children:g.map(u=>e.jsxs(t,{onClick:()=>ee(u.id),sx:{minWidth:120,cursor:"pointer",transition:"transform 0.2s","&:hover":{transform:"scale(1.05)"}},children:[e.jsx(t,{sx:{width:120,height:120,bgcolor:"#e0e0e0",borderRadius:1.5,overflow:"hidden",mb:.5},children:u.images&&u.images.length>0?e.jsx("img",{src:u.images[0],alt:u.title,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(t,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5"},children:e.jsx(o,{variant:"caption",color:"text.secondary",children:"Kein Bild"})})}),e.jsx(o,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",mb:.25},children:u.title}),e.jsxs(o,{variant:"body2",fontWeight:600,color:"primary",children:[u.price.toFixed(2)," €"]})]},u.id))}),e.jsx(F,{variant:"outlined",onClick:P,endIcon:e.jsx(q,{size:18}),fullWidth:!0,sx:{textTransform:"none",borderRadius:1.5,py:1},children:"Alle Inserate anzeigen"})]})]})},fr=()=>{var Ge,Oe,Xe,Ye,Ze,Je,Qe,es,ss,ts,rs,is,ns,as;const{id:c}=pt(),d=Cs(),p=gt(),{user:l}=ks(),{handPreference:g}=ut(),{isFavorite:m,toggleFavorite:b,loading:z}=ft(),y=ys(),n=_s(y.breakpoints.down("md")),[s,v]=x.useState(null),[W,T]=x.useState(!0),[P,ee]=x.useState(""),[u,B]=x.useState(!1),[G,se]=x.useState(!1),[ie,$]=x.useState(null),[O,Me]=x.useState(null),[R,de]=x.useState(null),[ve,he]=x.useState(!1),[E,ne]=x.useState(0),we=x.useRef(!1),[ae,zs]=x.useState(1),[Is,Fs]=x.useState(0),Ws=x.useRef(null),[xe,Rs]=x.useState(!1),[De,Be]=x.useState(null),[Le,pe]=x.useState([]),[a,te]=x.useState(!1),[i,oe]=x.useState({}),[ge,Ve]=x.useState(!1),[qe,le]=x.useState(!1),[As,ue]=x.useState(!1),[Es,Ns]=x.useState(!1),[Ts,Pe]=x.useState(!1),$e=x.useRef(null),[Ms,fe]=x.useState(!1),{status:Ds}=Zt({itemId:c||"",draftData:i,enabled:a&&qe,debounceMs:1500}),w=((Ge=p.state)==null?void 0:Ge.allItems)||[],X=w.findIndex(r=>r.id===c),M=X>0,D=X>=0&&X<w.length-1,He=()=>{const r=sessionStorage.getItem("returnSearch");r?(d(`/${r}`),sessionStorage.removeItem("returnSearch")):d("/")},I=x.useCallback(async r=>{const h=r==="prev"&&M?w[X-1]:r==="next"&&D?w[X+1]:null;if(!h)return;v(h),ne(0),window.scrollTo(0,0);const{data:_}=await C.from("item_images").select("image_url, display_order, is_primary").eq("item_id",h.id).order("display_order",{ascending:!0});_&&_.length>0?pe(_.map(L=>L.image_url)):pe(h.image_url?[h.image_url]:[]);const{data:N}=await C.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",h.user_id).maybeSingle();if(Me(N),h.selected_address_id){const{data:L}=await C.from("addresses").select("*").eq("id",h.selected_address_id).maybeSingle();de(L)}else de(null);we.current=!0,d(`/item/${h.id}`,{state:{allItems:w},replace:!0})},[w,X,M,D,d]),k=Le.length>0?Le:s!=null&&s.image_url?[s.image_url]:[],me=()=>{ne(r=>r===0?k.length-1:r-1)},be=()=>{ne(r=>r===k.length-1?0:r+1)},Bs=gs({onSwipedLeft:be,onSwipedRight:me,trackMouse:!1,trackTouch:!0}),Ls=gs({onSwipedLeft:()=>D&&I("next"),onSwipedRight:()=>M&&I("prev"),trackMouse:!1,trackTouch:!0});Yt(s==null?void 0:s.id,!!s),x.useEffect(()=>{const r=()=>{Rs(window.scrollY>500)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const je=()=>{window.scrollTo({top:0,behavior:"smooth"})},Ue=async()=>{if(c){if(we.current){we.current=!1;return}T(!0);try{const{data:r,error:h}=await C.from("items").select("*").eq("id",c).maybeSingle();if(h)throw h;if(!r){d("/");return}if(r.status==="draft"&&(!l||l.id!==r.user_id)){d("/");return}if(v(r),l&&l.id===r.user_id)if(r.status==="draft"){r.draft_data&&oe(r.draft_data),te(!0),le(!0);const{count:U}=await C.from("items").select("*",{count:"exact",head:!0}).eq("user_id",l.id).neq("status","draft"),os=U===0;Ns(os);const Zs=localStorage.getItem("hasSeenItemEditOnboarding");os&&!Zs&&setTimeout(()=>{Pe(!0)},800)}else r.has_draft&&r.draft_data&&(oe(r.draft_data),le(!0),te(!0));const{data:_}=await C.from("item_images").select("image_url, display_order, is_primary").eq("item_id",c).order("display_order",{ascending:!0});_&&_.length>0?pe(_.map(U=>U.image_url)):pe(r.image_url?[r.image_url]:[]);const{data:N,error:L}=await C.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",r.user_id).maybeSingle();if(L)throw L;if(Me(N),r.selected_address_id){const{data:U}=await C.from("addresses").select("*").eq("id",r.selected_address_id).maybeSingle();de(U)}else de(null)}catch(r){console.error("Error loading item:",r),d("/")}finally{T(!1)}}};x.useEffect(()=>{Ue()},[c,d]),x.useEffect(()=>(s!=null&&s.title&&(document.title=s.title),()=>{document.title="Bazar - Dein Online-Flohmarkt"}),[s==null?void 0:s.title]);const f=(r,h)=>{oe(_=>({..._,[r]:h})),le(!0)},Ke=async()=>{if(!(!s||!c)){Ve(!0);try{const{images:r,...h}=i,_={...h,status:s.status==="draft"?"published":s.status,has_draft:!1,draft_data:null,draft_updated_at:null,updated_at:new Date().toISOString()},{error:N}=await C.from("items").update(_).eq("id",c);if(N)throw N;v({...s,...h}),te(!1),le(!1),oe({}),await Ue()}catch(r){console.error("Error publishing:",r),$("Fehler beim Veröffentlichen der Änderungen")}finally{Ve(!1)}}},Vs=async()=>{if(c)try{await C.from("items").update({has_draft:!1,draft_data:null,draft_updated_at:null}).eq("id",c),te(!1),le(!1),oe({})}catch(r){console.error("Error canceling edit:",r)}};x.useEffect(()=>{window.scrollTo(0,0),ne(0)},[s==null?void 0:s.id]),x.useEffect(()=>{if(!n)return;const r=()=>{const h=window.scrollY,N=Math.max(0,1-h/600),L=-(h*.05);zs(N),Fs(L)};return window.addEventListener("scroll",r,{passive:!0}),()=>window.removeEventListener("scroll",r)},[n]),x.useEffect(()=>{const r=h=>{if(!(h.target instanceof HTMLInputElement||h.target instanceof HTMLTextAreaElement)&&!ve)switch(h.key){case"ArrowLeft":M&&(h.preventDefault(),I("prev"));break;case"ArrowRight":D&&(h.preventDefault(),I("next"));break;case"ArrowUp":M&&(h.preventDefault(),I("prev"));break;case"ArrowDown":D&&(h.preventDefault(),I("next"));break}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[M,D,ve,I]);const qs=async()=>{s&&await b(s.id)},S=()=>{},Ps=r=>{Be(r.currentTarget)},H=()=>{Be(null)},$s=async()=>{if(!s)return;const r=window.location.href;try{await navigator.clipboard.writeText(r),alert("Link wurde in die Zwischenablage kopiert!")}catch{const _=document.createElement("textarea");_.value=r,_.style.position="fixed",_.style.left="-999999px",document.body.appendChild(_),_.select();try{document.execCommand("copy"),alert("Link wurde in die Zwischenablage kopiert!")}catch(N){console.error("Error copying to clipboard:",N),alert("Kopieren fehlgeschlagen. Bitte manuell kopieren: "+r)}document.body.removeChild(_)}H()},Hs=()=>{if(!s)return;const r=window.location.href,h=`${s.title} - ${s.price.toFixed(2)} €`;window.open(`https://wa.me/?text=${encodeURIComponent(h+" "+r)}`,"_blank"),H()},Us=()=>{if(!s)return;const r=window.location.href;window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(r)}`,"_blank"),H()},Ks=()=>{if(!s)return;const r=window.location.href,h=`${s.title} - ${s.price.toFixed(2)} €`;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(h)}&url=${encodeURIComponent(r)}`,"_blank"),H()},Gs=()=>{if(!s)return;const r=window.location.href,h=`${s.title} - ${s.price.toFixed(2)} €`;window.open(`https://t.me/share/url?url=${encodeURIComponent(r)}&text=${encodeURIComponent(h)}`,"_blank"),H()},Os=()=>{if(!s)return;const r=window.location.href,h=s.title,_=`${s.title}

Preis: ${s.price.toFixed(2)} €

${r}`;window.location.href=`mailto:?subject=${encodeURIComponent(h)}&body=${encodeURIComponent(_)}`,H()},Xs=()=>{H(),window.print()},Ys=async()=>{if(!l){alert("Bitte melde dich an, um eine Nachricht zu senden.");return}if(!P.trim()||!s){$("Bitte gib eine Nachricht ein.");return}if(l.id===s.user_id){$("Du kannst dir selbst keine Nachricht senden.");return}B(!0),$(null);try{const{data:r,error:h}=await C.from("conversations").select("id").eq("item_id",s.id).eq("buyer_id",l.id).eq("seller_id",s.user_id).maybeSingle();if(h&&h.code!=="PGRST116")throw h;let _;if(r)_=r.id;else{const{data:L,error:U}=await C.from("conversations").insert({item_id:s.id,buyer_id:l.id,seller_id:s.user_id}).select("id").single();if(U)throw U;_=L.id}const{error:N}=await C.from("messages").insert({conversation_id:_,sender_id:l.id,content:P.trim()});if(N)throw N;ee(""),se(!0),setTimeout(()=>se(!1),3e3)}catch(r){console.error("Error sending message:",r),$("Fehler beim Senden der Nachricht. Bitte versuche es erneut.")}finally{B(!1)}};return W?e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:e.jsx(ls,{})}):s?e.jsxs(t,{sx:{minHeight:"100vh",bgcolor:"#fafafa"},children:[e.jsxs(t,{className:"print-only",sx:{display:"none"},children:[e.jsx(t,{className:"print-header",children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx(t,{children:e.jsx("img",{src:"/logo.png",alt:"HABDAWAS Logo",className:"print-logo"})}),e.jsx(t,{sx:{textAlign:"right",fontSize:"8pt",color:"#666"},children:e.jsxs(o,{variant:"caption",sx:{display:"block",fontSize:"8pt"},children:["Gedruckt: ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})}),e.jsx(t,{className:"print-main-section",children:e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(t,{className:"print-image-container",children:k.slice(0,1).map((r,h)=>e.jsx("img",{src:r,alt:s.title,className:"print-main-image"},h))}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{className:"print-title",children:s.title}),e.jsxs(t,{className:"print-price-box",children:[s.price.toFixed(2)," €"]})]})]})}),e.jsxs(t,{className:"print-details-grid",children:[(s.postal_code||s.location)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📍 Standort:"}),e.jsx(t,{className:"print-detail-value",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),s.condition&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✨ Zustand:"}),e.jsx(t,{className:"print-detail-value",children:mt(s.condition)})]}),s.brand&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🏷️ Marke:"}),e.jsx(t,{className:"print-detail-value",children:s.brand})]}),s.category&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📦 Kategorie:"}),e.jsx(t,{className:"print-detail-value",children:s.category})]}),s.subcategory&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📑 Unterkategorie:"}),e.jsx(t,{className:"print-detail-value",children:s.subcategory})]}),s.shipping_cost!==null&&s.shipping_cost!==void 0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🚚 Versandkosten:"}),e.jsx(t,{className:"print-detail-value",children:s.shipping_cost===0?"Kostenloser Versand":`${s.shipping_cost.toFixed(2)} €`})]}),s.size&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📏 Größe:"}),e.jsx(t,{className:"print-detail-value",children:s.size})]}),(s.dimensions_length||s.dimensions_width||s.dimensions_height)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📐 Abmessungen:"}),e.jsx(t,{className:"print-detail-value",children:s.dimensions_length&&s.dimensions_width&&s.dimensions_height?`${s.dimensions_length} × ${s.dimensions_width} × ${s.dimensions_height} cm`:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")+" cm"})]}),s.weight&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"⚖️ Gewicht:"}),e.jsx(t,{className:"print-detail-value",children:s.weight})]}),s.quantity&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Verfügbare Menge:"}),e.jsx(t,{className:"print-detail-value",children:s.quantity})]}),s.colors&&s.colors.length>0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🎨 Farben:"}),e.jsx(t,{className:"print-detail-value",children:s.colors.join(", ")})]}),s.material&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🧵 Material:"}),e.jsx(t,{className:"print-detail-value",children:s.material})]}),s.style&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✂️ Stil:"}),e.jsx(t,{className:"print-detail-value",children:s.style})]}),s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔖 Seriennummer:"}),e.jsx(t,{className:"print-detail-value",children:s.serial_number})]}),s.item_number&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Artikelnummer:"}),e.jsx(t,{className:"print-detail-value",children:s.item_number})]})]}),s.description&&e.jsxs(t,{className:"print-description-box",children:[e.jsx("span",{className:"print-section-title",children:"📝 Beschreibung:"}),e.jsx(o,{className:"print-description-text",children:s.description})]}),(((Oe=s.features)==null?void 0:Oe.length)>0||((Xe=s.accessories)==null?void 0:Xe.length)>0)&&e.jsxs(t,{className:"print-extra-box",children:[((Ye=s.features)==null?void 0:Ye.length)>0&&e.jsxs(t,{sx:{mb:1},children:[e.jsx("span",{className:"print-section-title",children:"⭐ Merkmale:"})," ",s.features.join(" • ")]}),((Ze=s.accessories)==null?void 0:Ze.length)>0&&e.jsxs(t,{children:[e.jsx("span",{className:"print-section-title",children:"🎁 Zubehör:"})," ",s.accessories.join(" • ")]})]}),O&&e.jsxs(t,{className:"print-contact-section",children:[e.jsx(t,{className:"print-section-title",children:"📞 Kontakt zum Anbieter:"}),e.jsxs(t,{sx:{fontSize:"8.5pt",lineHeight:1.5},children:[O.full_name&&e.jsxs(t,{children:[e.jsx("strong",{children:"Name:"})," ",O.full_name,O.phone_verified&&e.jsx(K,{icon:e.jsx(ms,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{ml:1,height:20}})]}),(R==null?void 0:R.phone)&&(R==null?void 0:R.show_phone_publicly)&&e.jsxs(t,{children:[e.jsx("strong",{children:"Telefon:"})," ",R.phone]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Nachricht:"})," Über HABDAWAS.at Nachrichten-System"]})]})]}),e.jsx(t,{className:"print-footer",children:e.jsxs(o,{variant:"caption",sx:{fontSize:"7pt"},children:["HABDAWAS.at • Hollenthon 33, 2812 Hollenthon • +43 650 25 26 266 • ID: ",s.id.slice(0,10)]})})]}),e.jsxs(bt,{anchorEl:De,open:!!De,onClose:H,PaperProps:{sx:{mt:1,minWidth:200,boxShadow:"0 4px 20px rgba(0,0,0,0.15)",borderRadius:2}},children:[e.jsxs(Y,{onClick:$s,children:[e.jsx(Z,{children:e.jsx($t,{size:20})}),e.jsx(J,{children:"Link kopieren"})]}),e.jsx(re,{sx:{my:.5}}),e.jsxs(Y,{onClick:Hs,children:[e.jsx(Z,{children:e.jsx(t,{sx:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",style:{width:"100%",height:"100%"},children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})})})}),e.jsx(J,{children:"WhatsApp"})]}),e.jsxs(Y,{onClick:Us,children:[e.jsx(Z,{children:e.jsx(t,{sx:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",style:{width:"100%",height:"100%"},children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})})}),e.jsx(J,{children:"Facebook"})]}),e.jsxs(Y,{onClick:Ks,children:[e.jsx(Z,{children:e.jsx(t,{sx:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",style:{width:"100%",height:"100%"},children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})})}),e.jsx(J,{children:"X (Twitter)"})]}),e.jsxs(Y,{onClick:Gs,children:[e.jsx(Z,{children:e.jsx(t,{sx:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",style:{width:"100%",height:"100%"},children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})})})}),e.jsx(J,{children:"Telegram"})]}),e.jsxs(Y,{onClick:Os,children:[e.jsx(Z,{children:e.jsx(At,{size:20})}),e.jsx(J,{children:"E-Mail"})]}),e.jsx(re,{sx:{my:.5}}),e.jsxs(Y,{onClick:Xs,children:[e.jsx(Z,{children:e.jsx(Ht,{size:20})}),e.jsx(J,{children:"Drucken"})]})]}),!n&&w.length>0&&e.jsx(t,{sx:{position:"fixed",top:72,left:0,right:0,zIndex:100,bgcolor:"white",borderBottom:"1px solid",borderColor:"divider",py:1.5},children:e.jsx(cs,{maxWidth:"lg",children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,height:48},children:[e.jsx(F,{variant:"text",startIcon:e.jsx(V,{size:18}),onClick:He,sx:{textTransform:"none",fontSize:"14px",fontWeight:500,px:2,height:40,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:"Zurück"}),(l==null?void 0:l.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:a?"contained":"outlined",startIcon:e.jsx(ke,{size:18}),onClick:()=>te(!a),sx:{textTransform:"none",fontSize:"14px",fontWeight:600,px:2.5,height:40,borderRadius:2,boxShadow:a?1:0},children:"Bearbeiten"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,px:2,py:.75,borderRadius:2,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(o,{sx:{fontSize:"13px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(j,{onClick:()=>ue(!0),sx:{color:"text.secondary",height:40,width:40,"&:hover":{bgcolor:"rgba(211, 47, 47, 0.08)",color:"error.main"}},children:e.jsx(jt,{size:18})})]}),e.jsx(t,{sx:{flex:1}}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,height:40,px:1.5,borderRadius:2,bgcolor:"rgba(0, 0, 0, 0.04)"},children:[e.jsx(j,{onClick:()=>I("prev"),disabled:!M,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx(V,{size:20})}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{minWidth:50,textAlign:"center",fontSize:"14px",fontWeight:500},children:[X+1," / ",w.length]}),e.jsx(j,{onClick:()=>I("next"),disabled:!D,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx(q,{size:20})})]})]})})}),e.jsxs(cs,{maxWidth:"lg",sx:{py:n?2:3,px:n?0:3,pt:!n&&w.length>0?14:n?2:3},children:[e.jsx(er,{itemId:s.id,itemStatus:s.status,onStatusChange:()=>{v({...s,status:s.status==="active"?"inactive":"active"})}}),l&&s&&l.id===s.user_id&&s.status==="published"&&s.has_draft&&e.jsxs(t,{sx:{mb:3,p:3,borderRadius:3,border:"2px solid",borderColor:"warning.main",bgcolor:"rgba(237, 108, 2, 0.04)",display:"flex",alignItems:"center",gap:3,flexDirection:n?"column":"row"},children:[e.jsx(t,{sx:{width:48,height:48,borderRadius:3,bgcolor:"warning.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(ke,{size:24,color:"white"})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,mb:.5,fontSize:"1.1rem"},children:"Unveröffentlichte Änderungen"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6},children:"Du hast Änderungen vorgenommen, die noch nicht veröffentlicht wurden. Übernimm die Änderungen, damit sie für andere sichtbar werden."})]}),e.jsx(F,{size:"large",variant:"contained",color:"warning",onClick:Ke,disabled:ge,startIcon:ge?e.jsx(ls,{size:18,color:"inherit"}):e.jsx(ws,{size:20}),sx:{minWidth:180,height:48,borderRadius:3,textTransform:"none",fontSize:"1rem",fontWeight:600,boxShadow:2,"&:hover":{boxShadow:4},flexShrink:0},children:ge?"Wird aktualisiert...":"Änderungen übernehmen"})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:n?"column":"row",gap:n?0:2},children:[!n&&e.jsx(t,{sx:{flex:"1 1 40%",position:"sticky",top:w.length>0?160:80,alignSelf:"flex-start",maxHeight:w.length>0?"calc(100vh - 260px)":"calc(100vh - 180px)",display:"flex",flexDirection:"column",gap:2},children:(l==null?void 0:l.id)===s.user_id&&a?e.jsxs(t,{sx:{position:"relative"},children:[e.jsx(us,{images:i.images||k.map(r=>({preview:r,existingUrl:r,isPrimary:r===k[0]})),onChange:r=>f("images",r),isEditing:a}),e.jsx(j,{onClick:()=>fe(!0),sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:10},children:e.jsx(ds,{size:20})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{position:"relative",width:"100%",height:k.length>1?"calc(100% - 120px)":"100%",bgcolor:"#f5f5f5",borderRadius:2,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:3},onClick:()=>he(!0),children:[e.jsx(t,{component:"img",src:Se(k[E]),alt:s.title,loading:"lazy",sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transition:"opacity 0.3s ease-in-out"}}),k.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:r=>{r.stopPropagation(),me()},disabled:E===0,sx:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx(V,{})}),e.jsx(j,{onClick:r=>{r.stopPropagation(),be()},disabled:E===k.length-1,sx:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx(q,{})}),e.jsxs(t,{sx:{position:"absolute",top:12,right:12,bgcolor:"rgba(0,0,0,0.65)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20},children:[E+1," / ",k.length]})]})]}),k.length>1&&e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-track":{bgcolor:"#f5f5f5",borderRadius:3},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3,"&:hover":{bgcolor:"#999"}}},children:k.map((r,h)=>e.jsxs(t,{onClick:()=>ne(h),sx:{minWidth:100,width:100,height:100,borderRadius:1.5,overflow:"hidden",cursor:"pointer",border:E===h?"3px solid #1976d2":"3px solid transparent",opacity:E===h?1:.6,transition:"all 0.2s ease",position:"relative","&:hover":{opacity:1,transform:"scale(1.05)"}},children:[e.jsx(t,{component:"img",src:Se(r),alt:`${s.title} - Vorschau ${h+1}`,loading:"lazy",sx:{width:"100%",height:"100%",objectFit:"cover"}}),h===0&&e.jsx(t,{sx:{position:"absolute",top:4,left:4,bgcolor:"primary.main",color:"white",px:.75,py:.25,borderRadius:1,fontSize:"0.65rem",fontWeight:700,textTransform:"uppercase"},children:"Haupt"})]},h))})]})}),e.jsxs(t,{...n&&w.length>0?Ls:{},sx:{flex:n?"1":"1 1 60%",bgcolor:"white",borderRadius:2,overflow:"visible",maxHeight:"none",mt:n?"-55px":0},children:[n&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{...Bs,sx:{position:"fixed",top:55,left:0,right:0,width:"100%",height:"400px",bgcolor:"#f5f5f5",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",overflow:"hidden",zIndex:1},onClick:()=>he(!0),children:[e.jsx(t,{component:"img",src:Se(k[E]),alt:s.title,loading:"lazy",sx:{width:"100%",height:"100%",display:"block",objectFit:"cover",objectPosition:"center",transform:`translateY(${Is}px)`,opacity:ae,transition:"opacity 0.1s ease-out",willChange:"transform, opacity"}}),(l==null?void 0:l.id)===s.user_id&&a&&e.jsx(j,{onClick:r=>{r.stopPropagation(),fe(!0)},sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:20,opacity:ae,transition:"opacity 0.1s ease-out"},children:e.jsx(ds,{size:20})}),k.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:r=>{r.stopPropagation(),me()},disabled:E===0,sx:{position:"absolute",left:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:ae,transition:"opacity 0.1s ease-out"},children:e.jsx(V,{})}),e.jsx(j,{onClick:r=>{r.stopPropagation(),be()},disabled:E===k.length-1,sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:ae,transition:"opacity 0.1s ease-out"},children:e.jsx(q,{})}),e.jsxs(t,{sx:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.6)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20,opacity:ae,transition:"opacity 0.1s ease-out"},children:[E+1," / ",k.length]})]})]}),w.length===0&&e.jsx(t,{sx:{height:"400px"}}),w.length>0&&e.jsx(t,{sx:{height:"400px"}}),e.jsxs(t,{sx:{position:"sticky",top:55,left:0,right:0,width:"100%",bgcolor:"white",borderBottom:"1px solid #e0e0e0",zIndex:100,px:2,py:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(F,{variant:"text",startIcon:e.jsx(V,{size:18}),onClick:He,sx:{textTransform:"none",fontWeight:600,color:"text.secondary",fontSize:"0.9375rem",px:0,bgcolor:"rgba(0, 0, 0, 0.02)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)",color:"primary.main"}},children:"Zurück zur Liste"}),e.jsxs(t,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(l==null?void 0:l.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5,px:1.25,py:.4,borderRadius:1.5,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:5,height:5,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(o,{sx:{fontSize:"10px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(j,{onClick:()=>te(!a),size:"small",sx:{color:a?"primary.main":"text.primary",bgcolor:a?"rgba(25, 118, 210, 0.08)":"transparent","&:hover":{bgcolor:a?"rgba(25, 118, 210, 0.12)":"rgba(0,0,0,0.04)"}},children:e.jsx(ke,{size:18})})]}),(l==null?void 0:l.id)!==s.user_id&&e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:qs,disabled:!l||z,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:s&&m(s.id)?e.jsx(hs,{size:18,fill:"currentColor"}):e.jsx(hs,{size:18})}),e.jsx(j,{onClick:Ps,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:e.jsx(Ut,{size:18})})]})]})]})]}),e.jsxs(t,{sx:{p:n?2:3,px:n?2:3,maxWidth:800,bgcolor:"white",borderRadius:0,position:"relative",zIndex:10},children:[e.jsx(t,{ref:$e,sx:{mb:n?1:3},children:e.jsx(A,{value:i.title||s.title,isEditing:a,onChange:r=>f("title",r),onSave:S,variant:n?"h5":"h4",placeholder:"Artikeltitel"})}),e.jsxs(t,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",mb:1.5},children:[(s.postal_code||s.location)&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ce,{size:18,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Et,{size:18,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:yt(s.created_at)})]})]}),e.jsx(t,{sx:{mb:n?1.5:3},children:a?e.jsxs(t,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:1.5},children:(i.is_free!==void 0?i.is_free:s.is_free)?e.jsx(o,{variant:n?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Zu verschenken"}):(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?e.jsx(o,{variant:n?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Auf Anfrage"}):e.jsxs(e.Fragment,{children:[e.jsx(A,{value:String(i.price!==void 0?i.price:s.price),isEditing:a,onChange:r=>f("price",parseFloat(r)||0),onSave:S,type:"number",variant:n?"h4":"h3",placeholder:"0.00",displayValue:`${parseFloat(String(i.price!==void 0?i.price:s.price)).toFixed(2)} €`,displayColor:"primary.main"}),(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(K,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})}),e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap",mt:1,alignItems:"center"},children:[e.jsxs(t,{onClick:()=>{const r=!(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable);f("price_negotiable",r),r&&(f("is_free",!1),f("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"not-allowed":"pointer",opacity:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?.5:1,userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"VB"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.is_free!==void 0?i.is_free:s.is_free);f("is_free",r),r&&(f("price_negotiable",!1),f("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.is_free!==void 0?i.is_free:s.is_free)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"Gratis"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.price_on_request!==void 0?i.price_on_request:s.price_on_request);f("price_on_request",r),r&&(f("is_free",!1),f("price_negotiable",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"Auf Anfrage"})]})]})]}):e.jsx(t,{children:e.jsxs(o,{variant:n?"h4":"h3",color:"primary.main",fontWeight:"bold",children:[s.is_free?"Zu verschenken":s.price_on_request?"Auf Anfrage":`${s.price.toFixed(2)} €`,s.price_negotiable&&!s.is_free&&!s.price_on_request&&e.jsx(K,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})})}),e.jsx(t,{sx:{display:"flex",gap:1,mb:n?1.5:3,flexWrap:"wrap",alignItems:"center"},children:e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap",width:"100%"},children:[e.jsx(t,{sx:{minWidth:200,flex:1},children:e.jsx(Fe,{value:i.condition||s.condition||"",isEditing:a,onChange:r=>f("condition",r),onSave:S,options:_t,placeholder:"Zustand wählen",label:"Zustand"})}),e.jsx(t,{sx:{minWidth:200,flex:1},children:e.jsx(A,{value:i.brand||s.brand||"",isEditing:a,onChange:r=>f("brand",r),onSave:S,placeholder:"Marke",label:"Marke"})})]})}),e.jsx(re,{sx:{my:n?2:3}}),e.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Beschreibung"}),e.jsx(A,{value:i.description||s.description,isEditing:a,onChange:r=>f("description",r),onSave:S,multiline:!0,rows:12,placeholder:"Artikelbeschreibung"}),(s.category||s.subcategory||s.size||s.weight||s.dimensions_length||s.material||((Je=s.colors)==null?void 0:Je.length)||s.style||((Qe=s.features)==null?void 0:Qe.length)||((es=s.accessories)==null?void 0:es.length)||s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt")&&e.jsxs(e.Fragment,{children:[e.jsx(re,{sx:{my:n?2:3}}),e.jsx(o,{variant:"h6",sx:{mb:3,fontWeight:600},children:"Produktdetails"}),e.jsxs(t,{sx:{display:"grid",gap:2},children:[(s.category||s.subcategory||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#2196f3":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(vt,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(Fe,{value:i.category||s.category||"",isEditing:a,onSave:S,onChange:r=>f("category",r),options:[{value:"Elektronik",label:"Elektronik"},{value:"Kleidung",label:"Kleidung"},{value:"Möbel",label:"Möbel"},{value:"Bücher",label:"Bücher"},{value:"Sport",label:"Sport"},{value:"Spielzeug",label:"Spielzeug"},{value:"Haushalt",label:"Haushalt"},{value:"Garten",label:"Garten"},{value:"Auto",label:"Auto & Motorrad"},{value:"Sonstiges",label:"Sonstiges"}],placeholder:"Kategorie wählen",label:"Kategorie"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Kategorie"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.category,s.subcategory].filter(Boolean).join(" › ")})]})})]}),(s.size&&s.size.toLowerCase()!=="unbekannt"||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(St,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(A,{value:i.size||s.size||"",isEditing:a,onSave:S,onChange:r=>f("size",r),label:"Größe",placeholder:"z.B. XL, 42, 180cm"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Größe"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.size})]})})]}),(s.weight&&s.weight.toLowerCase()!=="unbekannt"||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"warning.main"},children:e.jsx(Ct,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(A,{value:i.weight||s.weight||"",isEditing:a,onSave:S,onChange:r=>f("weight",r),label:"Gewicht",placeholder:"z.B. 500g, 2kg"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Gewicht"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.weight})]})})]}),(s.dimensions_length||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(zt,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsxs(t,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(A,{value:i.dimensions_length||s.dimensions_length||"",isEditing:a,onSave:S,onChange:r=>f("dimensions_length",r),label:"Länge (cm)",placeholder:"Länge"}),e.jsx(A,{value:i.dimensions_width||s.dimensions_width||"",isEditing:a,onSave:S,onChange:r=>f("dimensions_width",r),label:"Breite (cm)",placeholder:"Breite"}),e.jsx(A,{value:i.dimensions_height||s.dimensions_height||"",isEditing:a,onSave:S,onChange:r=>f("dimensions_height",r),label:"Höhe (cm)",placeholder:"Höhe"})]}):s.dimensions_length&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Abmessungen"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")})]})})]}),(s.material&&s.material.toLowerCase()!=="unbekannt"||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"secondary.main"},children:e.jsx(Ae,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(A,{value:i.material||s.material||"",isEditing:a,onSave:S,onChange:r=>f("material",r),label:"Material",placeholder:"z.B. Baumwolle, Holz, Metall"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Material"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.material})]})})]}),(s.style&&s.style.toLowerCase()!=="unbekannt"||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(wt,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(A,{value:i.style||s.style||"",isEditing:a,onSave:S,onChange:r=>f("style",r),label:"Stil",placeholder:"z.B. Modern, Vintage, Klassisch"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Stil"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.style})]})})]}),(((ss=s.colors)==null?void 0:ss.length)>0||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"error.main"},children:e.jsx(It,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(_e,{value:i.colors||s.colors||[],isEditing:a,onSave:S,onChange:r=>f("colors",r),label:"Farben",placeholder:"Farbe hinzufügen",color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Farben"}),e.jsx(t,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:1},children:(ts=s.colors)==null?void 0:ts.map((r,h)=>e.jsx(K,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"primary.50",color:"primary.dark",border:1,borderColor:"primary.200"}},h))})]})})]}),(((rs=s.features)==null?void 0:rs.length)>0||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#e8f5e9":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#4caf50":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(Ae,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(_e,{value:i.features||s.features||[],isEditing:a,onSave:S,onChange:r=>f("features",r),label:"Eigenschaften",placeholder:"Eigenschaft hinzufügen",color:"success"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Eigenschaften"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:(is=s.features)==null?void 0:is.map((r,h)=>e.jsx(K,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"success.50",color:"success.dark",border:1,borderColor:"success.200"}},h))})]})})]}),(((ns=s.accessories)==null?void 0:ns.length)>0||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#2196f3":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(ze,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(_e,{value:i.accessories||s.accessories||[],isEditing:a,onSave:S,onChange:r=>f("accessories",r),label:"Zubehör",placeholder:"Zubehör hinzufügen",color:"info"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Zubehör"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:s.accessories.map((r,h)=>e.jsx(K,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"info.50",color:"info.dark",border:1,borderColor:"info.200"}},h))})]})})]}),(s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"||a)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:a?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:a?"#ff9800":"grey.200"},children:[!a&&e.jsx(t,{sx:{mt:.25,color:"grey.600"},children:e.jsx(Ft,{size:20})}),e.jsx(t,{sx:{flex:1},children:a?e.jsx(A,{value:i.serial_number||s.serial_number||"",isEditing:a,onSave:S,onChange:r=>f("serial_number",r),label:"Seriennummer",placeholder:"Seriennummer oder Artikelnummer"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Seriennummer"}),e.jsx(o,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.95rem",color:"text.primary",fontWeight:500},children:s.serial_number})]})})]})]})]}),(((as=s.tags)==null?void 0:as.length)>0||a)&&e.jsxs(t,{sx:{mt:3,mb:3},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",sx:{fontWeight:600,mb:1},children:"Tags"}),a?e.jsx(_e,{value:i.tags||s.tags||[],isEditing:a,onSave:S,onChange:r=>f("tags",r),placeholder:"Tag hinzufügen und Enter drücken"}):e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:s.tags.map((r,h)=>e.jsx(K,{label:`#${r}`,size:"small",variant:"filled"},h))})]}),e.jsx(re,{sx:{my:n?2:3}}),(s.snapshot_shipping_enabled||s.snapshot_pickup_enabled||a)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Versand & Abholung"}),a?e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Ce,{size:n?18:20,color:"#1976d2"}),e.jsx(xs,{control:e.jsx(ps,{checked:i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled,onChange:r=>f("snapshot_pickup_enabled",r.target.checked)}),label:e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"}),sx:{m:0}})]}),(i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:l&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[s.snapshot_pickup_address,e.jsx("br",{}),s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]}):e.jsx(e.Fragment,{children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"})}),e.jsx(A,{value:i.snapshot_location_description!==void 0?i.snapshot_location_description:s.snapshot_location_description||"",isEditing:a,onChange:r=>f("snapshot_location_description",r),onSave:S,placeholder:"Optionale Beschreibung zur Abholung",label:"Abholbeschreibung"})]})]}),e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Ie,{size:n?18:20,color:"#1976d2"}),e.jsx(xs,{control:e.jsx(ps,{checked:i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled,onChange:r=>f("snapshot_shipping_enabled",r.target.checked)}),label:e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"}),sx:{m:0}})]}),(i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{value:i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type||"fixed",isEditing:a,onChange:r=>f("snapshot_shipping_cost_type",r),onSave:S,options:[{value:"free",label:"Kostenloser Versand"},{value:"fixed",label:"Feste Versandkosten"},{value:"ai_calculated",label:"KI-berechnet"}],label:"Versandkostentyp"}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="fixed"&&e.jsx(t,{sx:{mt:1},children:e.jsx(A,{value:String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0),isEditing:a,onChange:r=>f("snapshot_shipping_cost",parseFloat(r)||0),onSave:S,type:"number",placeholder:"0.00",label:"Versandkosten (€)",displayValue:`${parseFloat(String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0)).toFixed(2)} €`})}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mt:1.5,p:1.5,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(ze,{size:16,color:"#f57c00"}),e.jsx(o,{variant:"body2",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(o,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(o,{variant:"caption",color:"text.secondary",sx:{display:"block",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]})]}),e.jsx(t,{sx:{mt:1},children:e.jsx(A,{value:i.snapshot_shipping_description!==void 0?i.snapshot_shipping_description:s.snapshot_shipping_description||"",isEditing:a,onChange:r=>f("snapshot_shipping_description",r),onSave:S,placeholder:"Optionale Versandbeschreibung",label:"Versandbeschreibung"})})]})]})]}):e.jsxs(e.Fragment,{children:[s.snapshot_pickup_enabled&&e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ce,{size:n?18:20,color:"#1976d2"}),e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"})]}),l&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:s.snapshot_pickup_address}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]})]}):e.jsx(o,{variant:"body2",color:"text.secondary",children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"}),s.snapshot_location_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_location_description})]}),s.snapshot_shipping_enabled&&e.jsxs(e.Fragment,{children:[s.snapshot_shipping_cost_type==="free"&&e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ie,{size:n?18:20,color:"#1976d2"}),e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Versandkosten: Kostenlos"}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="fixed"&&e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ie,{size:n?18:20,color:"#1976d2"}),e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Versandkosten: ",s.snapshot_shipping_cost&&s.snapshot_shipping_cost>0?`${s.snapshot_shipping_cost.toFixed(2)} €`:"Auf Anfrage"]}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mb:2,p:n?1.5:2,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(ze,{size:n?18:20,color:"#f57c00"}),e.jsx(o,{variant:n?"body1":"subtitle1",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1.5,fontSize:"0.75rem"},children:"ⓘ Diese Versandkosten wurden automatisch von der KI basierend auf Größe und Gewicht geschätzt."}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1.5,fontStyle:"italic"},children:s.snapshot_shipping_description})]})]})]}),e.jsx(re,{sx:{my:n?2:3}})]}),!a&&s.user_id&&e.jsx(t,{sx:{mb:n?2:3},children:e.jsx(tr,{userId:s.user_id,currentItemId:s.id})}),e.jsxs(t,{sx:{bgcolor:"#f0f7ff",p:n?2:3,borderRadius:2,mb:n?2:3,border:"1px solid #e3f2fd"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600},children:"Verkäufer kontaktieren"}),(O==null?void 0:O.phone_verified)&&e.jsx(K,{icon:e.jsx(ms,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{height:24}})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2,lineHeight:1.6},children:"Interesse an diesem Artikel? Kontaktiere den Verkäufer für weitere Informationen oder um einen Kauf zu vereinbaren."}),(R==null?void 0:R.phone)&&(R==null?void 0:R.show_phone_publicly)&&e.jsxs(t,{sx:{mb:2,p:1.5,bgcolor:"white",borderRadius:1,border:"1px solid #e3f2fd",display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main",color:"white",borderRadius:"50%",width:36,height:36,flexShrink:0},children:e.jsx(Nt,{size:18})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.25},children:"Telefon"}),e.jsx(o,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:e.jsx("a",{href:`tel:${R.phone}`,style:{color:"inherit",textDecoration:"none"},children:R.phone})})]})]}),G&&e.jsx(Q,{severity:"success",sx:{mb:2},children:"Nachricht erfolgreich gesendet!"}),ie&&e.jsx(Q,{severity:"error",sx:{mb:2},onClose:()=>$(null),children:ie}),!l&&e.jsx(Q,{severity:"info",sx:{mb:2},children:"Bitte melde dich an, um den Verkäufer zu kontaktieren."}),l&&l.id===s.user_id&&e.jsx(Q,{severity:"info",sx:{mb:0},children:"Dies ist dein eigenes Inserat."}),l&&l.id!==s.user_id&&e.jsxs(e.Fragment,{children:[e.jsx(Ss,{fullWidth:!0,multiline:!0,rows:3,placeholder:"Schreibe eine Nachricht an den Verkäufer...",value:P,onChange:r=>ee(r.target.value),sx:{mb:2,bgcolor:"white"},disabled:!l,inputRef:Ws}),e.jsx(F,{variant:"contained",size:"large",fullWidth:!0,onClick:Ys,disabled:!l||!P.trim()||u,startIcon:e.jsx(Tt,{size:18}),children:u?"Wird gesendet...":"Nachricht senden"})]})]}),e.jsxs(o,{variant:"caption",color:"text.disabled",sx:{display:"block",fontSize:n?"0.7rem":"0.75rem"},children:["Inserat-ID: ",s.id.slice(0,8),n&&e.jsx("br",{})," • Veröffentlicht am ",new Date(s.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})," um ",new Date(s.created_at).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})]})]})]})]})]}),ve&&e.jsxs("div",{className:"lightbox-overlay",onClick:()=>he(!1),children:[e.jsx("button",{className:n?g==="left"?"lightbox-close lightbox-close-mobile lightbox-close-left":"lightbox-close lightbox-close-mobile":"lightbox-close",onClick:()=>he(!1),"aria-label":"Schließen",children:"✕"}),k.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:r=>{r.stopPropagation(),me()},disabled:E===0,sx:{position:"absolute",left:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx(V,{size:32})}),e.jsx(j,{onClick:r=>{r.stopPropagation(),be()},disabled:E===k.length-1,sx:{position:"absolute",right:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx(q,{size:32})}),e.jsxs(t,{sx:{position:"absolute",bottom:30,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.7)",color:"white",px:3,py:1,borderRadius:3,fontSize:"1rem",fontWeight:600,zIndex:1502},children:[E+1," / ",k.length]})]}),e.jsx("div",{className:"lightbox-content",onClick:r=>r.stopPropagation(),children:e.jsx("img",{src:kt(k[E]),alt:s.title,loading:"lazy"})})]}),!n&&e.jsx(t,{sx:{position:"fixed",bottom:0,left:0,right:0,display:"flex",justifyContent:g==="left"?"flex-start":"flex-end",px:3,pb:1.5,gap:1,zIndex:500,pointerEvents:"none","& > *":{pointerEvents:"auto"}},children:g==="right"?e.jsxs(e.Fragment,{children:[xe&&e.jsx(j,{onClick:je,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ye,{size:28})}),w.length>0&&M&&e.jsx(j,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(V,{size:28,color:"#1976d2"})}),w.length>0&&D&&e.jsx(j,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(q,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[w.length>0&&D&&e.jsx(j,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(q,{size:28,color:"#1976d2"})}),w.length>0&&M&&e.jsx(j,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(V,{size:28,color:"#1976d2"})}),xe&&e.jsx(j,{onClick:je,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ye,{size:28})})]})}),n&&e.jsx(t,{sx:{position:"fixed",left:g==="left"?16:"auto",right:g==="left"?"auto":16,bottom:24,display:"flex",gap:1,zIndex:500},children:g==="right"?e.jsxs(e.Fragment,{children:[xe&&e.jsx(j,{onClick:je,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ye,{size:28})}),w.length>0&&M&&e.jsx(j,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(V,{size:28,color:"#1976d2"})}),w.length>0&&D&&e.jsx(j,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(q,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[w.length>0&&D&&e.jsx(j,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(q,{size:28,color:"#1976d2"})}),w.length>0&&M&&e.jsx(j,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(V,{size:28,color:"#1976d2"})}),xe&&e.jsx(j,{onClick:je,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ye,{size:28})})]})}),e.jsx(fs,{open:As,onClose:()=>ue(!1),title:"Artikel löschen",maxWidth:"xs",actions:e.jsxs(e.Fragment,{children:[e.jsx(F,{onClick:()=>ue(!1),variant:"outlined",sx:{textTransform:"none"},children:"Abbrechen"}),e.jsx(F,{onClick:async()=>{await C.from("items").delete().eq("id",s==null?void 0:s.id),ue(!1),d("/")},variant:"contained",color:"error",sx:{textTransform:"none"},children:"Löschen"})]}),children:e.jsx(o,{children:"Möchtest du diesen Artikel wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden."})}),a&&l&&s&&l.id===s.user_id&&e.jsx(Jt,{onPublish:Ke,onCancel:Vs,isPublishing:ge,autoSaveStatus:Ds,hasChanges:qe,isDraft:s.status==="draft",itemStatus:s.status,isFirstItem:Es}),e.jsx(sr,{show:Ts,targetElement:$e.current,onClose:()=>{Pe(!1),localStorage.setItem("hasSeenItemEditOnboarding","true")},title:"Inline-Bearbeitung",description:"Klicke einfach auf einen beliebigen Bereich wie den Titel, die Beschreibung oder die Bilder, um sie direkt zu bearbeiten. Deine Änderungen werden automatisch gespeichert."}),e.jsx(fs,{open:Ms,onClose:()=>fe(!1),title:"Bilder verwalten",maxWidth:"xl",fullScreen:!0,actions:e.jsx(F,{onClick:()=>fe(!1),variant:"contained",sx:{textTransform:"none"},children:"Fertig"}),children:e.jsx(t,{sx:{height:"100%",overflowY:"auto",p:2},children:e.jsx(us,{images:i.images||k.map(r=>({preview:r,existingUrl:r,isPrimary:r===k[0]})),onChange:r=>f("images",r),isEditing:a})})})]}):null};export{fr as ItemDetailPage};
