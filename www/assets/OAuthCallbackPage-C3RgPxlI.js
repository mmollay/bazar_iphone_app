import{x as h,r as l,j as e,B as i,T as u,H as g,bo as d,f}from"./index-BTsOeNaN.js";const C=()=>{const r=h(),[o,a]=l.useState(null);return l.useEffect(()=>{(async()=>{try{const t=d.isNativePlatform(),n=window.location.href;if(console.log("[OAuth Callback] Processing URL:",n),console.log("[OAuth Callback] Platform:",t?"Native iOS":"Web"),t){if(console.log("[OAuth Callback] Native iOS detected - redirecting to app..."),!new URLSearchParams(window.location.search).get("code")){console.error("[OAuth Callback] No code in URL"),a("Kein Autorisierungscode gefunden.");return}const c=`habdawas://auth/callback?${window.location.search.substring(1)}`;console.log("[OAuth Callback] Redirecting to:",c),window.location.href=c;return}console.log("[OAuth Callback] Web platform - exchanging code for session...");const{error:s}=await f.auth.exchangeCodeForSession(n);if(s){console.error("[OAuth Callback] Exchange error:",s),a("Anmeldung fehlgeschlagen. Bitte versuche es erneut."),setTimeout(()=>r("/"),3e3);return}console.log("[OAuth Callback] Success! Redirecting to home..."),r("/",{replace:!0})}catch(t){console.error("[OAuth Callback] Error:",t),a("Ein Fehler ist aufgetreten. Du wirst weitergeleitet..."),setTimeout(()=>r("/"),3e3)}})()},[r]),o?e.jsx(i,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2},children:e.jsx(u,{variant:"h6",color:"error",children:o})}):e.jsxs(i,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2},children:[e.jsx(g,{size:60}),e.jsx(u,{variant:"h6",children:"Anmeldung wird verarbeitet..."})]})};export{C as OAuthCallbackPage};
