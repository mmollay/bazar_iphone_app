import{e as W,x as I,aG as P,ai as B,r as c,j as e,B as r,aY as H,R as b,l as y,T as i,aj as L,A,Z as h,aZ as D,ax as E,K as R,C as K,H as V,f as F}from"./index-BSWr4aeF.js";import{S as Z}from"./Snackbar-BHS2_Mh4.js";import{A as M}from"./arrow-left-CGCi59Dx.js";import{S as G}from"./sparkles-D2-_7dgR.js";import{S as N}from"./shopping-cart-dhfXIBTR.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=W("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),_=()=>{const l=I(),[j]=P(),{balance:S}=B(),[m,v]=c.useState(null),[x,u]=c.useState(!1),[f,a]=c.useState(null),[k,C]=c.useState(j.get("canceled")==="true"),p=[{id:"BASIC",tokens:125e3,price:4.9,bonus:0,estimatedListings:"~50",popular:!0,type:"purchase",features:["Verbrauchsbasiert","~50 Inserate mit KI","ca. 0,10€ pro Inserat","Ideal zum Starten"]},{id:"STANDARD",tokens:275e3,price:9.9,bonus:0,estimatedListings:"~110",bestValue:!0,type:"purchase",features:["Verbrauchsbasiert","~110 Inserate mit KI","ca. 0,09€ pro Inserat","10% günstiger","Für regelmäßige Verkäufer"]},{id:"PRO",tokens:437500,price:14.9,bonus:0,estimatedListings:"~175",type:"purchase",features:["Verbrauchsbasiert","~175 Inserate mit KI","ca. 0,085€ pro Inserat","30% günstiger","Für Vielverkäufer"]},{id:"SUPPORTER",tokens:12500,price:4.9,bonus:0,estimatedListings:"~5",type:"donation",features:["Unterstütze die Plattform","Hilf anderen Nutzern","Zeige deine Wertschätzung","Jeder Betrag hilft!"]}],z=async t=>{v(t),u(!0),a(null);try{const{data:{session:n}}=await F.auth.getSession(),d=n==null?void 0:n.access_token;if(!d){a("Bitte melde dich an, um Tokens zu kaufen.");return}const o=await fetch("https://hsbjflixgavjqxvnkivi.supabase.co/functions/v1/create-checkout-session",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({packageId:t.toLowerCase()})}),s=await o.json();if(!o.ok){s.needsConfig?a("Zahlungssystem ist noch nicht konfiguriert. Bitte kontaktiere den Administrator."):a(s.error||"Fehler beim Erstellen der Checkout-Session");return}s.url?window.location.href=s.url:a("Keine Checkout-URL erhalten")}catch(n){console.error("Error creating checkout session:",n),a(n instanceof Error?n.message:"Ein Fehler ist aufgetreten")}finally{u(!1)}},g=t=>{const n=t.tokens+t.bonus,d=(t.price/n).toFixed(4),o=t.popular||t.bestValue,s=t.type==="donation";return e.jsxs(E,{sx:{position:"relative",border:o||s?"2px solid":"1px solid",borderColor:s?"#e91e63":o?"primary.main":"divider",borderRadius:4,bgcolor:"white",overflow:"visible",transition:"all 0.3s ease",display:"flex",flexDirection:"column",boxShadow:o||s?2:0,"&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:[(o||s)&&e.jsx(R,{icon:s?e.jsx(h,{size:14}):t.popular?e.jsx(G,{size:14}):e.jsx(J,{size:14}),label:s?"Spende":t.popular?"Beliebt":"Beste Wahl",size:"small",sx:{position:"absolute",top:-12,right:20,bgcolor:s?"#e91e63":t.popular?"primary.main":"#ff9800",color:"white",fontWeight:700,fontSize:"0.75rem",height:26,px:1,"& .MuiChip-icon":{color:"white"},boxShadow:2}}),e.jsxs(r,{sx:{p:4,display:"flex",flexDirection:"column",flexGrow:1},children:[e.jsx(i,{variant:"overline",sx:{fontWeight:700,fontSize:"0.8rem",color:s?"#e91e63":"primary.main",letterSpacing:"0.12em",lineHeight:1},children:t.id}),e.jsxs(r,{sx:{my:2.5},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"baseline",gap:1},children:[e.jsx(i,{variant:"h2",sx:{fontWeight:800,fontSize:{xs:"2.75rem",sm:"3rem"},lineHeight:1,color:"text.primary"},children:n.toLocaleString("de-DE")}),e.jsx(i,{variant:"body1",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.9rem"},children:"Tokens"})]}),e.jsx(i,{variant:"body2",sx:{color:s?"#e91e63":"primary.main",fontWeight:600,mt:1,fontSize:"0.875rem"},children:s?"für die Community":`~${t.estimatedListings} Inserate`})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"baseline",gap:.5,mb:1,py:2.5,borderTop:"1px solid",borderBottom:"1px solid",borderColor:"divider"},children:[e.jsx(i,{variant:"h3",sx:{fontWeight:800,fontSize:{xs:"2rem",sm:"2.25rem"},lineHeight:1,color:"text.primary"},children:t.price.toFixed(2)}),e.jsx(i,{variant:"h5",color:"text.secondary",sx:{fontWeight:600},children:"€"})]}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{mb:3,fontSize:"0.8rem"},children:s?"Einmalige Spende":`${d}€ pro Token`}),e.jsx(r,{sx:{mb:3.5,flexGrow:1},children:t.features.map((w,T)=>e.jsxs(r,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,py:.75},children:[e.jsx(K,{size:18,style:{color:s?"#e91e63":"#4caf50",flexShrink:0,marginTop:"2px"}}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem",lineHeight:1.6},children:w})]},T))}),e.jsx(y,{fullWidth:!0,variant:o||s?"contained":"outlined",size:"large",startIcon:x&&m===t.id?e.jsx(V,{size:18,color:"inherit"}):s?e.jsx(h,{size:18}):e.jsx(N,{size:18}),onClick:()=>z(t.id),disabled:x,sx:{textTransform:"none",fontWeight:700,py:1.75,fontSize:"1rem",mt:"auto",borderRadius:2,...s&&{bgcolor:"#e91e63","&:hover":{bgcolor:"#c2185b"}},transition:"all 0.2s ease"},children:x&&m===t.id?"Laden...":s?"Jetzt spenden":"Kaufen"})]})]},t.id)};return e.jsxs(r,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(H,{onNavigate:t=>{t==="items"?l("/"):t==="messages"?l("/messages"):t==="settings"&&l("/settings")},onLoginClick:()=>{},showSearch:!1}),e.jsxs(r,{sx:{flex:1,bgcolor:"#fafafa"},children:[e.jsx(Z,{open:k,autoHideDuration:6e3,onClose:()=>C(!1),message:"Zahlung abgebrochen"}),e.jsx(r,{sx:{bgcolor:"white",borderBottom:"1px solid",borderColor:"divider",py:2},children:e.jsx(b,{maxWidth:"lg",children:e.jsx(y,{startIcon:e.jsx(M,{size:18}),onClick:()=>l(-1),sx:{textTransform:"none",fontWeight:500,color:"text.secondary"},children:"Zurück"})})}),e.jsxs(b,{maxWidth:"lg",sx:{py:6},children:[e.jsxs(r,{sx:{mb:5,textAlign:"center"},children:[e.jsx(i,{variant:"h4",sx:{fontWeight:700,mb:2,color:"text.primary",fontSize:{xs:"1.75rem",sm:"2rem",md:"2.125rem"}},children:"Tokens kaufen oder spenden"}),e.jsxs(i,{variant:"body1",color:"text.secondary",sx:{mb:2,maxWidth:700,mx:"auto",lineHeight:1.7},children:["Jeden Monat erhältst du ",e.jsx("strong",{children:"10 kostenlose Inserate"}),"! Brauchst du mehr? Kein Problem - kaufe einfach Token nach. Wer viel verkauft, verdient meist auch gut und kann mit fairem Preis-Leistungs-Verhältnis weiter machen."]}),e.jsxs(i,{variant:"body2",color:"text.secondary",sx:{mb:3,maxWidth:700,mx:"auto",lineHeight:1.7},children:["Die Plattform bleibt für Gelegenheitsverkäufer komplett ",e.jsx("strong",{children:"kostenlos"}),"! Mit deiner Spende oder deinem Token-Kauf unterstützt du den weiteren Betrieb und hilfst der gesamten Community."]}),e.jsxs(r,{sx:{display:"inline-flex",alignItems:"center",gap:1.5,px:3,py:1.25,borderRadius:12,bgcolor:"rgba(25, 118, 210, 0.08)",border:"1px solid rgba(25, 118, 210, 0.2)"},children:[e.jsx(L,{size:20,style:{color:"#1976d2"}}),e.jsxs(i,{variant:"body1",sx:{fontWeight:600,color:"primary.main"},children:["Dein Guthaben: ",S," Tokens"]})]})]}),f&&e.jsx(A,{severity:"error",onClose:()=>a(null),sx:{mb:4,maxWidth:800,mx:"auto"},children:f}),e.jsx(r,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(3, 1fr)"},gap:3,mb:5},children:p.filter(t=>t.type==="purchase").map(g)}),e.jsxs(r,{sx:{borderTop:"1px solid",borderColor:"divider",pt:5,mt:5},children:[e.jsxs(r,{sx:{textAlign:"center",mb:4},children:[e.jsxs(i,{variant:"h5",sx:{fontWeight:700,mb:1,display:"flex",alignItems:"center",gap:1,justifyContent:"center"},children:[e.jsx(h,{size:22,style:{color:"#e91e63"}}),"Unterstütze die Community"]}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{maxWidth:600,mx:"auto",lineHeight:1.7},children:"Mit deiner Spende ermöglichst du kostenlosen Zugang für alle und hilfst beim Ausbau der Plattform"})]}),e.jsx(r,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(r,{sx:{maxWidth:400,width:"100%"},children:p.filter(t=>t.type==="donation").map(g)})})]})]})]}),e.jsx(D,{})]})};export{_ as TokenPurchasePage};
