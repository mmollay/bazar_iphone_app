import{x as d,r as u,j as e,B as h,T as g,H as f,f as m}from"./index-Do3xeu9r.js";const w=()=>{const r=d(),[a,o]=u.useState(null);return u.useEffect(()=>{(async()=>{try{const t=window.location.href,n=new URLSearchParams(window.location.search),s=n.get("platform")==="ios";if(console.log("[OAuth Callback] Processing URL:",t),console.log("[OAuth Callback] Platform:",s?"Native iOS (from URL param)":"Web"),s){if(console.log("[OAuth Callback] Native iOS request detected - redirecting to app..."),!n.get("code")){console.error("[OAuth Callback] No code in URL"),o("Kein Autorisierungscode gefunden.");return}const l=new URLSearchParams(window.location.search);l.delete("platform");const i=`habdawas://auth/callback?${l.toString()}`;console.log("[OAuth Callback] Redirecting to:",i),window.location.href=i;return}console.log("[OAuth Callback] Web platform - exchanging code for session...");const{error:c}=await m.auth.exchangeCodeForSession(t);if(c){console.error("[OAuth Callback] Exchange error:",c),o("Anmeldung fehlgeschlagen. Bitte versuche es erneut."),setTimeout(()=>r("/"),3e3);return}console.log("[OAuth Callback] Success! Redirecting to home..."),r("/",{replace:!0})}catch(t){console.error("[OAuth Callback] Error:",t),o("Ein Fehler ist aufgetreten. Du wirst weitergeleitet..."),setTimeout(()=>r("/"),3e3)}})()},[r]),a?e.jsx(h,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2},children:e.jsx(g,{variant:"h6",color:"error",children:a})}):e.jsxs(h,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2},children:[e.jsx(f,{size:60}),e.jsx(g,{variant:"h6",children:"Anmeldung wird verarbeitet..."})]})};export{w as OAuthCallbackPage};
